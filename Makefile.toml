[env]
CARGO_MAKE_EXTEND_WORKSPACE_MAKEFILE = true
RUST_LOG = "info"

[tasks.ingester]
workspace = false
command = "cargo"
args = [
	"run", "--release","--bin", "eth-archive-ingester", "--",
	"--data-path", "${CARGO_MAKE_WORKSPACE_WORKING_DIRECTORY}/data",
	"--eth-rpc-url", "http://65.21.143.239:8646",
	"--request-timeout-secs", "300",
	"--connect-timeout-ms", "1000",
	"--block-batch-size", "50",
	"--http-req-concurrency", "100",
	"--best-block-offset", "10",
	"--max-blocks-per-file", "300000",
	"--max-txs-per-file", "200000",
	"--max-logs-per-file", "200000",
]

[tasks.gateway]
workspace = false
command = "cargo"
args = [
	"run", "--release", "--bin", "eth-archive-gateway", "--",
	"--data-path", "${CARGO_MAKE_WORKSPACE_WORKING_DIRECTORY}/data",
	"--max-block-range", "500000",
	"--default-block-range", "1000000",
	"--response-log-limit", "10000",
	"--query-chunk-size", "256",
	"--query-time-limit-ms", "6000",
]

[tasks.sync-s3]
workspace = false
command = "mc"
args = [
	"mirror", "--watch",
	"${CARGO_MAKE_WORKSPACE_WORKING_DIRECTORY}/data",
	"subsquid-filebase/eth0",
	"--exclude", "*temp/*", "--overwrite"
]
